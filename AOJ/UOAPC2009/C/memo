Emacs-like Editor

Emacs とはUNIXのプログラマ等多くのコンピュータ技術者に愛用されているテキストエディタである。

Emacs の魅力は矢印キーを使わなくともカーソルを移動できることにある。例えば、Control キーを押しながらf、b、n、pを押せばカーソルをそれぞれ右、左、下、上に１つ移動することができる。また、カット＆ペーストなどの操作もキーボードのみで可能であり、マウスを使うことなく文章を素早く作成することができる。

あなたの仕事は、Emacsの簡易版エディタの操作をシミュレートするプログラムを作成することである。プログラムは、文章を読み込み、与えられた操作を実行した後の文章を出力しなければならない。

このエディタで編集する文章は複数の行から構成され、各行は０個以上のアルファベットと空白を含む文字から構成される。文字を含まない場合は空行となる。

また、このエディタには１つの文字または行末を指し示す１つのカーソルをもつ。（文字がない空行であってもカーソルは行末を指すことができることに注意せよ。）

さらにこのエディタは、１つの文字列または１つの改行を保持しておくバッファを持つ。

与えられる操作は以下のものを含む：
（対象となる行が空行である場合は、「先頭文字」を行末と置き換える）

a
カーソルを現在の行の先頭文字に移動する。
 
e
カーソルを現在の行の行末に移動する。

p
上に行があれば、カーソルを上の行の先頭文字に移動する。
上に行がなければ、カーソルを先頭文字に移動する。

n
下に行があれば、カーソルを下の行の先頭文字に移動する。
下に行がなければ、カーソルを先頭文字に移動する。

f
カーソルが行末にない場合１つ右に移動する。
カーソルが行末にありかつ下に行がある場合は、下の行の先頭文字へ移動する。
それ以外の場合は何もしない。

b
カーソルが先頭文字でないならば、１つ左に移動する。
カーソルが先頭文字でありかつ上に行がある場合は、上の行の行末へ移動する。
それ以外の場合は何もしない。

d
カーソルが文字を指す場合はその文字を削除し、削除された文字の右側の文字列を左にシフトする。
カーソルが行末を指し下に行がある場合は、以下の行をそのままカーソルの位置に繋げる。以下の行はシフトされる。
それ以外の場合は何もしない。

k
カーソルが行末の場合、C-dと同じ操作をし、バッファに１つの改行を記録する。
カーソルが行末でない場合、カーソルを含め右側すべての文字を切り取りそれをバッファに記録する。カーソルは元の行の行末を指すようになる。全ての記録においてバッファは上書きされる。

y
バッファが空の場合はなにもしない。
バッファの内容が改行の場合、カーソルの位置で改行を行う。カーソルは改行された行の先頭文字へ移動する。
バッファの内容が文字列の場合、カーソルの位置にバッファの内容を挿入する。
カーソルの位置はもともと指していた文字または行末の場所へ移動する。

文章が入力された時点でカーソルは１行目の１文字目を指しており、バッファは空である。

hyo
ni
END_OF_TEXT
f
d
f
f
k
p
p
e
y
a
k
y
y
n
y
-

honihoni
honi