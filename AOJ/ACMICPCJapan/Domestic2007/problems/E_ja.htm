
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">

<head>
<link rel="STYLESHEET" 
      href=icpc.css
      type="text/css">

<meta http-equiv="Content-Type" 
      content="text/html; charset=euc-jp">

<title>Problem E</title>
</head>

<body>

<table class="main">
<!-- ------------ 1st row ---------------- -->
<!-- |        ACM Inter Collegiate Programming Contest       | -->
<tr>
 <td colspan=2 align=center>
  
<h1><img src=IMAGES/icpc_logo.png 
alt="acm International Collegiate Programming Contest"/></h1>
<div class=banner align=right><font size=-1>
<i>2007/7/6 Tokyo</i></font></div> </td>
</tr>

<!-- ------------ 2nd row ---------------- -->
<!-- menu in the 1st column. empty in the 2nd. -->
<tr>
 <td class=menu rowspan=4 valign=top nowrap>
  </td>
 <td>
  </td>
</tr>

<!-- ------------ 3rd row ---------------- -->
<!-- no 1st column. empty in the 2nd. -->
<tr>
 <td>
  </td>
</tr>

<!-- ------------ 4th row ------------ -->
<!-- nothing in the 1st column. everything else in the 2nd -->
<tr>
 <td class="main">

</div>
<a name=section_E><h2>Problem E</h2>
<!-- begin ja only -->
<h3><U>くるくる</U></h3>
<!-- end ja only -->

<div>   <!-- please enclose each h3 level section with div -->

<!-- begin ja only -->
<p>
2次元平面上の多角形の壁の内側を，時計回りに回転する棒を考える(図1参照)．
</p>
<!-- end ja only -->

<div align="center">
<!-- <img src="rot_triangle.gif" /><br /> -->
<img src="IMAGES/E2.png" />
<br />
<!-- begin ja only -->
<p>図1. 多角形の内側で回転する棒</p>
<!-- end ja only -->
</div>


<!-- begin ja only -->
<p>
最初は棒の片端(A端と呼ぶ)が(0,0)，他端(B端と呼ぶ)が(0,<I>L</I>)にある．
<I>L</I>は棒の長さである．棒は最初はA端のみで壁に接している．
</p>
<!-- end ja only -->

<!-- begin ja only -->
<p>
棒は壁に接している点を中心にして回転する．
新たな点が壁に接すると，回転の中心も変わる．
</p>
<!-- end ja only -->

<!-- begin ja only -->
<p>
あなたの仕事は棒が与えられた回数<I>R</I>だけ回転し終わった時点での
A端の座標を計算することである．
</p>
<!-- end ja only -->



<div align="center">
<img src="IMAGES/E5.png" />
<br />
<!-- begin ja only -->
<p>図2. 棒の回転のさまざまな例</p>
<!-- end ja only -->
</div>

<!-- begin ja only -->
<p>図2にいくつかの例を示す．(D)と(E)では，棒は途中でつかえた
(壁に接しているいずれの点を中心としても，それ以上時計回りに回転できない) 状態となる．そのような場合は，
その (つかえた) 状態でのA端の座標を出力すること．</p>
<!-- end ja only -->

<!-- begin ja only -->
<p>以下のことを前提としてよい:</p>
<blockquote>
棒の長さ <i>L</i> が &epsilon; (|&epsilon;| &lt; 0.00001) だけ変化したとき，
結果の(<i>x</i>,<i>y</i>)座標が 0.0005 より大きく変化することはない．
</blockquote>
<!-- end ja only -->

</div>

<h3>Input</h3>

<div>
<!-- begin ja only -->
<p>入力は複数のデータセットから成る．データセットの個数は100以下である．
入力の終わりは「0 0 0」で示される．</p>
<!-- end ja only -->


<!-- begin ja only -->
<p>
各データセットは以下の形式で与えられる:
</p>
<!-- end ja only -->

<pre>
<i>L</i> <i>R</i> <i>N</i>
<i>X</i><sub>1</sub> <i>Y</i><sub>1</sub>
<i>X</i><sub>2</sub> <i>Y</i><sub>2</sub>
...
<i>X</i><sub>N</sub> <i>Y</i><sub>N</sub>
</pre>

<!-- begin ja only -->

<p>
<i>L</i>は棒の長さである．棒は，途中ではつかえない場合，
2π×<i>R</i> ラジアン回転する．<i>N</i>は多角形を構成する頂点の個数である．
</p>

<p>
多角形の頂点は，反時計回りの順番で並べられている．
多角形は<em>単純</em>であると仮定して構わない．
すなわち，多角形の外周が自分自身と接触ないし交差することはない．
</p>

<p>
<i>N</i>, <i>X</i><sub>i</sub>, <i>Y</i><sub>i</sub> は整数で，
その他の値は十進小数である．それらの値の範囲は次の通り:
</p>
<!-- end ja only -->

<pre>
1.0 &le; <i>L</i> &le; 500.0,
1.0 &le; <i>R</i> &le; 10.0,
3 &le; <i>N</i> &le; 100,
-1000 &le; <i>X</i><sub>i</sub> &le; 1000,
-1000 &le; <i>Y</i><sub>i</sub> &le; 1000,
</pre>

<pre>
<i>X</i><sub>1</sub> &le; -1,  <i>Y</i><sub>1</sub> = 0,
<i>X</i><sub>2</sub> &ge; 1,  <i>Y</i><sub>2</sub> = 0.
</pre>
</div>

<h3>Output</h3>
<div>
<!-- begin ja only -->

<p>
それぞれのデータセットに対して，A端の最終状態におけるx座標とy座標を，
スペース1個で区切った1行として出力すること．
出力する値は0.001以下の誤差を含んでいても構わない．
また，値は小数点以下何桁表示しても構わない．
</p>
<!-- end ja only -->

</div>

<h3>Sample Input</h3>
<div>
<pre>
4.0 2.0 8
-1 0
5 0
5 -2
7 -2
7 0
18 0
18 6
-1 6
4.0 2.0 4
-1 0
10 0
10 12
-1 12
4.0 1.0 7
-1 0
2 0
-1 -3
-1 -8
6 -8
6 6
-1 6
4.0 2.0 6
-1 0
10 0
10 3
7 3
7 5
-1 5
5.0 2.0 6
-1 0
2 0
2 -4
6 -4
6 6
-1 6
6.0 1.0 8
-1 0
8 0
7 2
9 2
8 4
11 4
11 12
-1 12
0 0 0
</pre>
</div>

<h3>Output for the Sample Input</h3>
<div>
<pre>
16.0 0.0
9.999999999999998 7.4641016151377535
0.585786437626906 -5.414213562373095
8.0 0.0
6.0 0.0
9.52786404500042 4.0
</pre>

</div>

<div>
<!-- begin ja only -->
なお，上記のサンプル入力は図2の各ケースに対応している．
また，図3にケース(C)の様子を示すアニメーションと分解写真を示す．
<!-- end ja only -->

<div align="center">
<img src="IMAGES/E6.gif" />
<br />

<TABLE>
<TR><TD><IMG src="IMAGES/stopMotion/Eframe0000.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0045.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0090.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0135.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0180.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0225.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0270.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/Eframe0315.png"></TD>
    <TD><IMG src="IMAGES/stopMotion/EframeLast.png"></TD></TR>
</TABLE>

<!-- begin ja only -->
<p>図3. ケース(C)に対するアニメーションと分解写真</p>
<!-- end ja only -->
</div>

</div>


 </td>                     
</tr>                      
</table>                   

</body>
</html>




