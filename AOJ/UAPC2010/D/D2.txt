Problem D: Distorted Love

好きな人のことをよく知りたいと思うのは当然のことだ。そう言いながら彼女は、彼の住所氏名年齢電話番号から、出身地病歴支持政党寝るときの姿勢に至るまで、ありとあらゆる個人情報を調べ上げた。彼女の辞書にプライバシーという言葉はない。彼女のような人を専門用語でストーカーとかヤンデレとか呼んだりするらしいが、そんなことも彼女にとってはどうでもいいことなのだった。

彼のことをもっとよく知るために、彼女は彼のパソコンにスパイウェアを仕掛けた。このスパイウェアは、彼がブラウザでWebページを閲覧している間、彼のマウス操作を記録をするのだ。彼女はしばらくの間このスパイウェアを彼に使わせ、そして操作の記録を極秘裏のうちに回収することに成功した。

さて、この操作の記録から、彼がどのWebページを見ていたかを復元するプログラムを作成して欲しい。

全てのページは H * W の大きさであり、左上の座標が (0, 0), 右下の座標が (W, H) となっている。ページはいくつかの
(軸に平行な) 長方形のボタンを含む。これらのボタンはリンクになっていて、これらの内側がクリックされたとき、そのボタンに対応するページへと遷移する。

彼が使うブラウザは、以下のようにして閲覧履歴や表示するページを管理する。

ブラウザは、複数のページを格納できる十分に長い1次元配列状のバッファと、そのバッファ内の1つのページを指すポインタを持つ。このポインタが指しているページが、常にユーザに表示される。最初、このバッファにはあらかじめ定められた1つのページのみが格納され、ポインタはそのページを指す。
リンクボタンがクリックされると、現在ポインタが指しているページよりも右側のページは全て削除される。その後で、リンクボタンが指す先のページがバッファの右端に追加され、ポインタは右に一つ移動する。結果として、ユーザはリンクボタンが指す先のページを見ることになる。
ブラウザは特殊なボタンとして、「前のページに戻る」「次のページに進む」の2つのボタンを持つ。「前のページに戻る」ボタンを押すとポインタは左に一つ移動し、「次のページへ進む」ボタンを押すとポインタは右に一つ移動する。どちらの場合も、バッファにそのようなページが格納されていなかった場合は何も起きない。

彼女が回収した彼のブラウザの操作の記録は、以下のような命令からなる。

click x y
座標 (x, y) をクリックしたことを表す。もしクリックした場所にボタンがあれば (ボタンの左端・右端の x 座標をそれぞれx1, x2
として x1 <= x <= x2 であり、かつボタンの上端・下端の y 座標をそれぞれy1, y2  として y1 <= y <= y2
であれば)、そのボタンが押されたものとみなされる。

back
「前のページに戻る」ボタンを押したことを表す。

forward
「次のページに進む」ボタンを押したことを表す。

この他に、特別な命令 show が与えられる。あなたの各プログラムは、この命令が与えられる度に、現在のページの名前を出力しなければならない。


ところで、他人のパソコンにスパイウェアを仕掛けることは法に抵触する恐れがあります。偉い人にすっごく怒られるので、真似しないでください。


-- 
----------------